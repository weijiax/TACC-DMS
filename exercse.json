{"paragraphs":[{"text":"%sh \nwhoami\npwd \nhostname\n#wget https://www.kaggle.com/uciml/iris/downloads/Iris.csv\n#hadoop fs -put Iris.csv /tmp/\n#hadoop fs -cat cars.tab/part-00000-2867678e-f673-4745-b19d-48ba95ac8d43.csv\n\nhadoop fs -ls \nhadoop fs -ls cars.parquet \nhadoop fs -ls cars.csv","user":"xwj","dateUpdated":"2017-05-04T00:24:49-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"xwj\n/home/00791/xwj\nc252-139.wrangler.tacc.utexas.edu\nFound 4 items\ndrwxr-xr-x   - xwj hadoop          0 2017-05-03 22:51 .sparkStaging\ndrwxr-xr-x   - xwj hadoop          0 2017-05-03 23:46 cars.json\ndrwxr-xr-x   - xwj hadoop          0 2017-05-03 23:46 cars.parquet\ndrwxr-xr-x   - xwj hadoop          0 2017-05-04 00:02 cars.tab\nFound 2 items\n-rw-r--r--   2 xwj hadoop          0 2017-05-03 23:46 cars.parquet/_SUCCESS\n-rw-r--r--   2 xwj hadoop       3832 2017-05-03 23:46 cars.parquet/part-00000-050bda0b-df4c-46e2-a6b9-4be56c67daac.snappy.parquet\nls: `cars.csv': No such file or directory\n"},{"type":"TEXT","data":"ExitValue: 1"}]},"apps":[],"jobName":"paragraph_1493863820933_-1157717208","id":"20170503-211020_1247123651","dateCreated":"2017-05-03T21:10:20-0500","dateStarted":"2017-05-04T00:24:50-0500","dateFinished":"2017-05-04T00:25:18-0500","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4415"},{"text":"\nval df=spark.read.format(\"csv\")\n            .option(\"header\", true)\n            .load(\"file:///work/00791/xwj/DMS/R-training/RDataMining/mtcars.csv\")\ndf.show()\ndf.printSchema\ndf.describe().show\ndf.describe(\"mpg\").show","user":"xwj","dateUpdated":"2017-05-04T03:43:06-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndf: org.apache.spark.sql.DataFrame = [model: string, mpg: string ... 10 more fields]\n+-------------------+----+---+-----+---+----+-----+-----+---+---+----+----+\n|              model| mpg|cyl| disp| hp|drat|   wt| qsec| vs| am|gear|carb|\n+-------------------+----+---+-----+---+----+-----+-----+---+---+----+----+\n|          Mazda RX4|  21|  6|  160|110| 3.9| 2.62|16.46|  0|  1|   4|   4|\n|      Mazda RX4 Wag|  21|  6|  160|110| 3.9|2.875|17.02|  0|  1|   4|   4|\n|         Datsun 710|22.8|  4|  108| 93|3.85| 2.32|18.61|  1|  1|   4|   1|\n|     Hornet 4 Drive|21.4|  6|  258|110|3.08|3.215|19.44|  1|  0|   3|   1|\n|  Hornet Sportabout|18.7|  8|  360|175|3.15| 3.44|17.02|  0|  0|   3|   2|\n|            Valiant|18.1|  6|  225|105|2.76| 3.46|20.22|  1|  0|   3|   1|\n|         Duster 360|14.3|  8|  360|245|3.21| 3.57|15.84|  0|  0|   3|   4|\n|          Merc 240D|24.4|  4|146.7| 62|3.69| 3.19|   20|  1|  0|   4|   2|\n|           Merc 230|22.8|  4|140.8| 95|3.92| 3.15| 22.9|  1|  0|   4|   2|\n|           Merc 280|19.2|  6|167.6|123|3.92| 3.44| 18.3|  1|  0|   4|   4|\n|          Merc 280C|17.8|  6|167.6|123|3.92| 3.44| 18.9|  1|  0|   4|   4|\n|         Merc 450SE|16.4|  8|275.8|180|3.07| 4.07| 17.4|  0|  0|   3|   3|\n|         Merc 450SL|17.3|  8|275.8|180|3.07| 3.73| 17.6|  0|  0|   3|   3|\n|        Merc 450SLC|15.2|  8|275.8|180|3.07| 3.78|   18|  0|  0|   3|   3|\n| Cadillac Fleetwood|10.4|  8|  472|205|2.93| 5.25|17.98|  0|  0|   3|   4|\n|Lincoln Continental|10.4|  8|  460|215|   3|5.424|17.82|  0|  0|   3|   4|\n|  Chrysler Imperial|14.7|  8|  440|230|3.23|5.345|17.42|  0|  0|   3|   4|\n|           Fiat 128|32.4|  4| 78.7| 66|4.08|  2.2|19.47|  1|  1|   4|   1|\n|        Honda Civic|30.4|  4| 75.7| 52|4.93|1.615|18.52|  1|  1|   4|   2|\n|     Toyota Corolla|33.9|  4| 71.1| 65|4.22|1.835| 19.9|  1|  1|   4|   1|\n+-------------------+----+---+-----+---+----+-----+-----+---+---+----+----+\nonly showing top 20 rows\n\nroot\n |-- model: string (nullable = true)\n |-- mpg: string (nullable = true)\n |-- cyl: string (nullable = true)\n |-- disp: string (nullable = true)\n |-- hp: string (nullable = true)\n |-- drat: string (nullable = true)\n |-- wt: string (nullable = true)\n |-- qsec: string (nullable = true)\n |-- vs: string (nullable = true)\n |-- am: string (nullable = true)\n |-- gear: string (nullable = true)\n |-- carb: string (nullable = true)\n\n+-------+-----------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-------------------+------------------+------------------+\n|summary|      model|               mpg|               cyl|              disp|               hp|              drat|                wt|              qsec|                vs|                 am|              gear|              carb|\n+-------+-----------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-------------------+------------------+------------------+\n|  count|         32|                32|                32|                32|               32|                32|                32|                32|                32|                 32|                32|                32|\n|   mean|       null|20.090624999999996|            6.1875|230.72187500000004|         146.6875|3.5965625000000006|3.2172499999999995|17.848750000000003|            0.4375|            0.40625|            3.6875|            2.8125|\n| stddev|       null| 6.026948052089103|1.7859216469465444|123.93869383138195|68.56286848932059|0.5346787360709716|0.9784574429896968|1.7869432360968436|0.5040161287741853|0.49899091723584604|0.7378040652569471|1.6151999776318522|\n|    min|AMC Javelin|              10.4|                 4|               108|              105|              2.76|             1.513|              14.5|                 0|                  0|                 3|                 1|\n|    max| Volvo 142E|              33.9|                 8|              95.1|               97|              4.93|             5.424|              22.9|                 1|                  1|                 5|                 8|\n+-------+-----------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-------------------+------------------+------------------+\n\n+-------+------------------+\n|summary|               mpg|\n+-------+------------------+\n|  count|                32|\n|   mean|20.090624999999996|\n| stddev| 6.026948052089103|\n|    min|              10.4|\n|    max|              33.9|\n+-------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1493863865200_1143343370","id":"20170503-211105_1236025868","dateCreated":"2017-05-03T21:11:05-0500","dateStarted":"2017-05-04T03:43:06-0500","dateFinished":"2017-05-04T03:43:19-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4416","title":"DataFrame Basic"},{"user":"xwj","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493888259593_-636412565","id":"20170504-035739_1672506467","dateCreated":"2017-05-04T03:57:39-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6687","dateUpdated":"2017-05-04T04:08:33-0500","dateFinished":"2017-05-04T04:08:40-0500","dateStarted":"2017-05-04T04:08:33-0500","title":"SparkSQL Basic ","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+----+-----+\n|              model| mpg|   wt|\n+-------------------+----+-----+\n|          Mazda RX4|  21| 2.62|\n|      Mazda RX4 Wag|  21|2.875|\n|         Datsun 710|22.8| 2.32|\n|     Hornet 4 Drive|21.4|3.215|\n|  Hornet Sportabout|18.7| 3.44|\n|            Valiant|18.1| 3.46|\n|         Duster 360|14.3| 3.57|\n|          Merc 240D|24.4| 3.19|\n|           Merc 230|22.8| 3.15|\n|           Merc 280|19.2| 3.44|\n|          Merc 280C|17.8| 3.44|\n|         Merc 450SE|16.4| 4.07|\n|         Merc 450SL|17.3| 3.73|\n|        Merc 450SLC|15.2| 3.78|\n| Cadillac Fleetwood|10.4| 5.25|\n|Lincoln Continental|10.4|5.424|\n|  Chrysler Imperial|14.7|5.345|\n|           Fiat 128|32.4|  2.2|\n|        Honda Civic|30.4|1.615|\n|     Toyota Corolla|33.9|1.835|\n+-------------------+----+-----+\nonly showing top 20 rows\n\n+-------------------+------------------+\n|              model|       (mpg * 1.6)|\n+-------------------+------------------+\n|          Mazda RX4|              33.6|\n|      Mazda RX4 Wag|              33.6|\n|         Datsun 710|36.480000000000004|\n|     Hornet 4 Drive|             34.24|\n|  Hornet Sportabout|             29.92|\n|            Valiant|28.960000000000004|\n|         Duster 360|22.880000000000003|\n|          Merc 240D|             39.04|\n|           Merc 230|36.480000000000004|\n|           Merc 280|             30.72|\n|          Merc 280C|28.480000000000004|\n|         Merc 450SE|             26.24|\n|         Merc 450SL|27.680000000000003|\n|        Merc 450SLC|             24.32|\n| Cadillac Fleetwood|             16.64|\n|Lincoln Continental|             16.64|\n|  Chrysler Imperial|             23.52|\n|           Fiat 128|             51.84|\n|        Honda Civic|             48.64|\n|     Toyota Corolla|             54.24|\n+-------------------+------------------+\nonly showing top 20 rows\n\n+-------------------+----+-----+---+\n|              model| mpg|   wt|cyl|\n+-------------------+----+-----+---+\n|          Mazda RX4|  21| 2.62|  6|\n|      Mazda RX4 Wag|  21|2.875|  6|\n|     Hornet 4 Drive|21.4|3.215|  6|\n|  Hornet Sportabout|18.7| 3.44|  8|\n|            Valiant|18.1| 3.46|  6|\n|         Duster 360|14.3| 3.57|  8|\n|           Merc 280|19.2| 3.44|  6|\n|          Merc 280C|17.8| 3.44|  6|\n|         Merc 450SE|16.4| 4.07|  8|\n|         Merc 450SL|17.3| 3.73|  8|\n|        Merc 450SLC|15.2| 3.78|  8|\n| Cadillac Fleetwood|10.4| 5.25|  8|\n|Lincoln Continental|10.4|5.424|  8|\n|  Chrysler Imperial|14.7|5.345|  8|\n|   Dodge Challenger|15.5| 3.52|  8|\n|        AMC Javelin|15.2|3.435|  8|\n|         Camaro Z28|13.3| 3.84|  8|\n|   Pontiac Firebird|19.2|3.845|  8|\n|     Ford Pantera L|15.8| 3.17|  8|\n|       Ferrari Dino|19.7| 2.77|  6|\n+-------------------+----+-----+---+\nonly showing top 20 rows\n\n+---+-----+\n|cyl|count|\n+---+-----+\n|  8|   14|\n|  6|    7|\n|  4|   11|\n+---+-----+\n\n"}]},"text":"df.select(\"model\",\"mpg\", \"wt\").show\ndf.select($\"model\", $\"mpg\" * 1.6).show\ndf.select(\"model\",\"mpg\", \"wt\", \"cyl\")\n  .filter(\"cyl > 4\").show\ndf.groupBy(\"cyl\").count().show\n"},{"user":"xwj","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493889111298_895311677","id":"20170504-041151_202712030","dateCreated":"2017-05-04T04:11:51-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6954","dateUpdated":"2017-05-04T04:24:45-0500","dateFinished":"2017-05-04T04:24:50-0500","dateStarted":"2017-05-04T04:24:45-0500","title":"Running SQL Statement","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+----+---+-----+---+----+-----+-----+---+---+----+----+\n|         model| mpg|cyl| disp| hp|drat|   wt| qsec| vs| am|gear|carb|\n+--------------+----+---+-----+---+----+-----+-----+---+---+----+----+\n|     Mazda RX4|  21|  6|  160|110| 3.9| 2.62|16.46|  0|  1|   4|   4|\n| Mazda RX4 Wag|  21|  6|  160|110| 3.9|2.875|17.02|  0|  1|   4|   4|\n|Hornet 4 Drive|21.4|  6|  258|110|3.08|3.215|19.44|  1|  0|   3|   1|\n|       Valiant|18.1|  6|  225|105|2.76| 3.46|20.22|  1|  0|   3|   1|\n|      Merc 280|19.2|  6|167.6|123|3.92| 3.44| 18.3|  1|  0|   4|   4|\n|     Merc 280C|17.8|  6|167.6|123|3.92| 3.44| 18.9|  1|  0|   4|   4|\n|  Ferrari Dino|19.7|  6|  145|175|3.62| 2.77| 15.5|  0|  1|   5|   6|\n+--------------+----+---+-----+---+----+-----+-----+---+---+----+----+\n\n+---+------------------+-----+\n|cyl|           avg_mpg|count|\n+---+------------------+-----+\n|  8|15.100000000000003|   14|\n|  6| 19.74285714285714|    7|\n|  4|26.663636363636364|   11|\n+---+------------------+-----+\n\n"}]},"text":"df.createOrReplaceTempView(\"cars\")\nspark.sql(\"SELECT * FROM cars WHERE cyl = 6\")\n     .show\nspark.sql(\"SELECT cyl, avg(mpg) as avg_mpg, count(1) as count \"+\n          \"from cars \"+\n          \"group by cyl\")\n     .show"},{"user":"xwj","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493882830723_947474492","id":"20170504-022710_1247940487","dateCreated":"2017-05-04T02:27:10-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5155","text":"df.show(5)\ndf.printSchema\ndf.describe().show\ndf.filter(\"mpg>20\").show","dateUpdated":"2017-05-04T03:37:05-0500","dateFinished":"2017-05-04T03:37:17-0500","dateStarted":"2017-05-04T03:37:05-0500","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+----+---+----+---+----+-----+-----+---+---+----+----+\n|            model| mpg|cyl|disp| hp|drat|   wt| qsec| vs| am|gear|carb|\n+-----------------+----+---+----+---+----+-----+-----+---+---+----+----+\n|        Mazda RX4|  21|  6| 160|110| 3.9| 2.62|16.46|  0|  1|   4|   4|\n|    Mazda RX4 Wag|  21|  6| 160|110| 3.9|2.875|17.02|  0|  1|   4|   4|\n|       Datsun 710|22.8|  4| 108| 93|3.85| 2.32|18.61|  1|  1|   4|   1|\n|   Hornet 4 Drive|21.4|  6| 258|110|3.08|3.215|19.44|  1|  0|   3|   1|\n|Hornet Sportabout|18.7|  8| 360|175|3.15| 3.44|17.02|  0|  0|   3|   2|\n+-----------------+----+---+----+---+----+-----+-----+---+---+----+----+\nonly showing top 5 rows\n\nroot\n |-- model: string (nullable = true)\n |-- mpg: string (nullable = true)\n |-- cyl: string (nullable = true)\n |-- disp: string (nullable = true)\n |-- hp: string (nullable = true)\n |-- drat: string (nullable = true)\n |-- wt: string (nullable = true)\n |-- qsec: string (nullable = true)\n |-- vs: string (nullable = true)\n |-- am: string (nullable = true)\n |-- gear: string (nullable = true)\n |-- carb: string (nullable = true)\n\n+-------+-----------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-------------------+------------------+------------------+\n|summary|      model|               mpg|               cyl|              disp|               hp|              drat|                wt|              qsec|                vs|                 am|              gear|              carb|\n+-------+-----------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-------------------+------------------+------------------+\n|  count|         32|                32|                32|                32|               32|                32|                32|                32|                32|                 32|                32|                32|\n|   mean|       null|20.090624999999996|            6.1875|230.72187500000004|         146.6875|3.5965625000000006|3.2172499999999995|17.848750000000003|            0.4375|            0.40625|            3.6875|            2.8125|\n| stddev|       null| 6.026948052089103|1.7859216469465444|123.93869383138195|68.56286848932059|0.5346787360709716|0.9784574429896968|1.7869432360968436|0.5040161287741853|0.49899091723584604|0.7378040652569471|1.6151999776318522|\n|    min|AMC Javelin|              10.4|                 4|               108|              105|              2.76|             1.513|              14.5|                 0|                  0|                 3|                 1|\n|    max| Volvo 142E|              33.9|                 8|              95.1|               97|              4.93|             5.424|              22.9|                 1|                  1|                 5|                 8|\n+-------+-----------+------------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-------------------+------------------+------------------+\n\n+--------------+----+---+-----+---+----+-----+-----+---+---+----+----+\n|         model| mpg|cyl| disp| hp|drat|   wt| qsec| vs| am|gear|carb|\n+--------------+----+---+-----+---+----+-----+-----+---+---+----+----+\n|     Mazda RX4|  21|  6|  160|110| 3.9| 2.62|16.46|  0|  1|   4|   4|\n| Mazda RX4 Wag|  21|  6|  160|110| 3.9|2.875|17.02|  0|  1|   4|   4|\n|    Datsun 710|22.8|  4|  108| 93|3.85| 2.32|18.61|  1|  1|   4|   1|\n|Hornet 4 Drive|21.4|  6|  258|110|3.08|3.215|19.44|  1|  0|   3|   1|\n|     Merc 240D|24.4|  4|146.7| 62|3.69| 3.19|   20|  1|  0|   4|   2|\n|      Merc 230|22.8|  4|140.8| 95|3.92| 3.15| 22.9|  1|  0|   4|   2|\n|      Fiat 128|32.4|  4| 78.7| 66|4.08|  2.2|19.47|  1|  1|   4|   1|\n|   Honda Civic|30.4|  4| 75.7| 52|4.93|1.615|18.52|  1|  1|   4|   2|\n|Toyota Corolla|33.9|  4| 71.1| 65|4.22|1.835| 19.9|  1|  1|   4|   1|\n| Toyota Corona|21.5|  4|120.1| 97| 3.7|2.465|20.01|  1|  0|   3|   1|\n|     Fiat X1-9|27.3|  4|   79| 66|4.08|1.935| 18.9|  1|  1|   4|   1|\n| Porsche 914-2|  26|  4|120.3| 91|4.43| 2.14| 16.7|  0|  1|   5|   2|\n|  Lotus Europa|30.4|  4| 95.1|113|3.77|1.513| 16.9|  1|  1|   5|   2|\n|    Volvo 142E|21.4|  4|  121|109|4.11| 2.78| 18.6|  1|  1|   4|   2|\n+--------------+----+---+-----+---+----+-----+-----+---+---+----+----+\n\n"}]}},{"text":"\nval car_rdd = df.rdd\ncar_rdd.filter(_(1).asInstanceOf[String].toDouble > 20).collect","user":"xwj","dateUpdated":"2017-05-04T02:32:52-0500","config":{"colWidth":4,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":268,"optionOpen":false}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ncar_rdd: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = MapPartitionsRDD[58] at rdd at <console>:27\n\nres100: Array[org.apache.spark.sql.Row] = Array([Mazda RX4,21,6,160,110,3.9,2.62,16.46,0,1,4,4], [Mazda RX4 Wag,21,6,160,110,3.9,2.875,17.02,0,1,4,4], [Datsun 710,22.8,4,108,93,3.85,2.32,18.61,1,1,4,1], [Hornet 4 Drive,21.4,6,258,110,3.08,3.215,19.44,1,0,3,1], [Merc 240D,24.4,4,146.7,62,3.69,3.19,20,1,0,4,2], [Merc 230,22.8,4,140.8,95,3.92,3.15,22.9,1,0,4,2], [Fiat 128,32.4,4,78.7,66,4.08,2.2,19.47,1,1,4,1], [Honda Civic,30.4,4,75.7,52,4.93,1.615,18.52,1,1,4,2], [Toyota Corolla,33.9,4,71.1,65,4.22,1.835,19.9,1,1,4,1], [Toyota Corona,21.5,4,120.1,97,3.7,2.465,20.01,1,0,3,1], [Fiat X1-9,27.3,4,79,66,4.08,1.935,18.9,1,1,4,1], [Porsche 914-2,26,4,120.3,91,4.43,2.14,16.7,0,1,5,2], [Lotus Europa,30.4,4,95.1,113,3.77,1.513,16.9,1,1,5,2], [Volvo 142E,21.4,4,121,109,4.11,2.78,18.6,1,1,4,2])\n"}]},"apps":[],"jobName":"paragraph_1493870913965_1069340691","id":"20170503-230833_689221345","dateCreated":"2017-05-03T23:08:33-0500","dateStarted":"2017-05-04T02:30:58-0500","dateFinished":"2017-05-04T02:30:59-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4417"},{"text":"//val df=spark.read.format(\"csv\").option(\"header\", true).load(\"/tmp/data/mtcars.csv\")\ndf.show(100)\ndf.write.format(\"json\").mode(\"overwrite\").save(\"cars.json\")\ndf.write.parquet(\"cars.parquet\")\ndf.write.option(\"delimiter\",\"\\t\").csv(\"cars.tab\")\nval df_json = spark.read.json(\"cars.json\")\nval df_parquet = spark.read.parquet(\"cars.parquet\")\ndf_json.show\ndf_parquet.show","user":"xwj","dateUpdated":"2017-05-04T02:58:50-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"+-------------------+----+---+-----+---+----+-----+-----+---+---+----+----+\n|              model| mpg|cyl| disp| hp|drat|   wt| qsec| vs| am|gear|carb|\n+-------------------+----+---+-----+---+----+-----+-----+---+---+----+----+\n|          Mazda RX4|  21|  6|  160|110| 3.9| 2.62|16.46|  0|  1|   4|   4|\n|      Mazda RX4 Wag|  21|  6|  160|110| 3.9|2.875|17.02|  0|  1|   4|   4|\n|         Datsun 710|22.8|  4|  108| 93|3.85| 2.32|18.61|  1|  1|   4|   1|\n|     Hornet 4 Drive|21.4|  6|  258|110|3.08|3.215|19.44|  1|  0|   3|   1|\n|  Hornet Sportabout|18.7|  8|  360|175|3.15| 3.44|17.02|  0|  0|   3|   2|\n|            Valiant|18.1|  6|  225|105|2.76| 3.46|20.22|  1|  0|   3|   1|\n|         Duster 360|14.3|  8|  360|245|3.21| 3.57|15.84|  0|  0|   3|   4|\n|          Merc 240D|24.4|  4|146.7| 62|3.69| 3.19|   20|  1|  0|   4|   2|\n|           Merc 230|22.8|  4|140.8| 95|3.92| 3.15| 22.9|  1|  0|   4|   2|\n|           Merc 280|19.2|  6|167.6|123|3.92| 3.44| 18.3|  1|  0|   4|   4|\n|          Merc 280C|17.8|  6|167.6|123|3.92| 3.44| 18.9|  1|  0|   4|   4|\n|         Merc 450SE|16.4|  8|275.8|180|3.07| 4.07| 17.4|  0|  0|   3|   3|\n|         Merc 450SL|17.3|  8|275.8|180|3.07| 3.73| 17.6|  0|  0|   3|   3|\n|        Merc 450SLC|15.2|  8|275.8|180|3.07| 3.78|   18|  0|  0|   3|   3|\n| Cadillac Fleetwood|10.4|  8|  472|205|2.93| 5.25|17.98|  0|  0|   3|   4|\n|Lincoln Continental|10.4|  8|  460|215|   3|5.424|17.82|  0|  0|   3|   4|\n|  Chrysler Imperial|14.7|  8|  440|230|3.23|5.345|17.42|  0|  0|   3|   4|\n|           Fiat 128|32.4|  4| 78.7| 66|4.08|  2.2|19.47|  1|  1|   4|   1|\n|        Honda Civic|30.4|  4| 75.7| 52|4.93|1.615|18.52|  1|  1|   4|   2|\n|     Toyota Corolla|33.9|  4| 71.1| 65|4.22|1.835| 19.9|  1|  1|   4|   1|\n|      Toyota Corona|21.5|  4|120.1| 97| 3.7|2.465|20.01|  1|  0|   3|   1|\n|   Dodge Challenger|15.5|  8|  318|150|2.76| 3.52|16.87|  0|  0|   3|   2|\n|        AMC Javelin|15.2|  8|  304|150|3.15|3.435| 17.3|  0|  0|   3|   2|\n|         Camaro Z28|13.3|  8|  350|245|3.73| 3.84|15.41|  0|  0|   3|   4|\n|   Pontiac Firebird|19.2|  8|  400|175|3.08|3.845|17.05|  0|  0|   3|   2|\n|          Fiat X1-9|27.3|  4|   79| 66|4.08|1.935| 18.9|  1|  1|   4|   1|\n|      Porsche 914-2|  26|  4|120.3| 91|4.43| 2.14| 16.7|  0|  1|   5|   2|\n|       Lotus Europa|30.4|  4| 95.1|113|3.77|1.513| 16.9|  1|  1|   5|   2|\n|     Ford Pantera L|15.8|  8|  351|264|4.22| 3.17| 14.5|  0|  1|   5|   4|\n|       Ferrari Dino|19.7|  6|  145|175|3.62| 2.77| 15.5|  0|  1|   5|   6|\n|      Maserati Bora|  15|  8|  301|335|3.54| 3.57| 14.6|  0|  1|   5|   8|\n|         Volvo 142E|21.4|  4|  121|109|4.11| 2.78| 18.6|  1|  1|   4|   2|\n+-------------------+----+---+-----+---+----+-----+-----+---+---+----+----+\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\norg.apache.spark.sql.AnalysisException: path hdfs://c252-138.wrangler.tacc.utexas.edu:8020/user/xwj/cars.parquet already exists.;\n  at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:80)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:58)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:56)\n  at org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:74)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:114)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:114)\n  at org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:135)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:132)\n  at org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:113)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:87)\n  at org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:87)\n  at org.apache.spark.sql.execution.datasources.DataSource.write(DataSource.scala:492)\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:215)\n  at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:198)\n  at org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:494)\n  ... 46 elided\n"}]},"apps":[],"jobName":"paragraph_1493873097018_618141314","id":"20170503-234457_749150403","dateCreated":"2017-05-03T23:44:57-0500","dateStarted":"2017-05-04T02:58:50-0500","dateFinished":"2017-05-04T02:58:54-0500","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:4418","title":"Read and Write with DataFrame"},{"text":"import org.apache.spark.sql.types.StructType\nval rdd = sc.parallelize(0 until 100)\nval rdd_df =rdd.toDF\nval rdd_ds = rdd.toDS\n\nrdd.filter (_ < 10).collect\nrdd_df.filter(\"value < 10\").show\nrdd_ds.filter(\"value < 10\").show\nrdd_ds.filter(_ < 10).show\n\nrdd.map(_ * 2).collect\nrdd_ds.map(_ * 2).show\nrdd_df.map(_ * 2).show //this line will fail \nrdd_df.select('value * 2).show \n\n\n\n//val mySchema = StructType($\"id\".int :: Nil)\n//val rdd_df2=spark.createDataFrame(rdd, mySchema)\n//val rdd_df2=rdd.toDF(mySchema)\n//rdd_df2.show\n\n//val res = rdd.map(x => x*2)\n//res.collect()\n//val reduce_res = rdd.reduce(_+_)\n//val even_res = rdd.filter(_%7 ==0)\n//even_res.collect()\n\n\n\n","user":"xwj","dateUpdated":"2017-05-04T03:34:44-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nimport org.apache.spark.sql.types.StructType\n\nrdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[345] at parallelize at <console>:47\n\nrdd_df: org.apache.spark.sql.DataFrame = [value: int]\n\nrdd_ds: org.apache.spark.sql.Dataset[Int] = [value: int]\n\nres191: Array[Int] = Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9)\n+-----+\n|value|\n+-----+\n|    0|\n|    1|\n|    2|\n|    3|\n|    4|\n|    5|\n|    6|\n|    7|\n|    8|\n|    9|\n+-----+\n\n+-----+\n|value|\n+-----+\n|    0|\n|    1|\n|    2|\n|    3|\n|    4|\n|    5|\n|    6|\n|    7|\n|    8|\n|    9|\n+-----+\n\n+-----+\n|value|\n+-----+\n|    0|\n|    1|\n|    2|\n|    3|\n|    4|\n|    5|\n|    6|\n|    7|\n|    8|\n|    9|\n+-----+\n\n\nres195: Array[Int] = Array(0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198)\n+-----+\n|value|\n+-----+\n|    0|\n|    2|\n|    4|\n|    6|\n|    8|\n|   10|\n|   12|\n|   14|\n|   16|\n|   18|\n|   20|\n|   22|\n|   24|\n|   26|\n|   28|\n|   30|\n|   32|\n|   34|\n|   36|\n|   38|\n+-----+\nonly showing top 20 rows\n\n+-----------+\n|(value * 2)|\n+-----------+\n|          0|\n|          2|\n|          4|\n|          6|\n|          8|\n|         10|\n|         12|\n|         14|\n|         16|\n|         18|\n|         20|\n|         22|\n|         24|\n|         26|\n|         28|\n|         30|\n|         32|\n|         34|\n|         36|\n|         38|\n+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1493863939331_1565721041","id":"20170503-211219_2086974375","dateCreated":"2017-05-03T21:12:19-0500","dateStarted":"2017-05-04T03:33:05-0500","dateFinished":"2017-05-04T03:33:15-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4419","title":"RDD vs. Dataset Vs. DataFrame"},{"user":"xwj","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493880951919_389322619","id":"20170504-015551_1853969066","dateCreated":"2017-05-04T01:55:51-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4660","text":"//val rdd = sc.parallelize(0 until 10000)\n//val rdd_df = rdd.toDF\n//rdd_df.show\n\ncase class Person(id: Int, name: String)\nval person = sc.parallelize(Seq( Person(1, \"Mike\"), \n                                 Person(2, \"Smith\"), \n                                 Person(3, \"Brooke\")))\nval person_df = person.toDF\nperson_df.show ","dateUpdated":"2017-05-04T02:21:35-0500","dateFinished":"2017-05-04T02:21:40-0500","dateStarted":"2017-05-04T02:21:35-0500","title":"RDD to DataFrame","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndefined class Person\n\nperson: org.apache.spark.rdd.RDD[Person] = ParallelCollectionRDD[160] at parallelize at <console>:31\n\nperson_df: org.apache.spark.sql.DataFrame = [id: int, name: string]\n+---+------+\n| id|  name|\n+---+------+\n|  1|  Mike|\n|  2| Smith|\n|  3|Brooke|\n+---+------+\n\n"}]}},{"user":"xwj","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493866218476_1614446758","id":"20170503-215018_419936693","dateCreated":"2017-05-03T21:50:18-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:4420"}],"name":"Excerise","id":"2CHWYQVN7","angularObjects":{"2CHB9RXNP:shared_process":[],"2CEX9YV8T:shared_process":[],"2CEUQSWRJ:shared_process":[],"2CEDUV3TX:shared_process":[],"2CFEWQAYC:shared_process":[],"2CGK7GVC5:shared_process":[],"2CHYQD7BC:shared_process":[],"2CE8WYTPJ:shared_process":[],"2CG4Y39UQ:shared_process":[],"2CFJ4THYD:shared_process":[],"2CGBTRMDU:shared_process":[],"2CHFP4H7P:shared_process":[],"2CEE39PDM:shared_process":[],"2CGHN9PZR:shared_process":[],"2CG5FU1UQ:shared_process":[],"2CFBVDFB9:shared_process":[],"2CGD8RAW7:shared_process":[],"2CEFD6C1V:shared_process":[],"2CG3GPWK3:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}